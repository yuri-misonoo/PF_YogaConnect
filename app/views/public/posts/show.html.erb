<div class="row">
  <div class="col-lg-6 col-md-9 col-sm-12 mx-auto">
    <h4>投稿詳細ページ</h4>
    
    <%= link_to user_path(@post.user), class: 'text-secondary' do %>
      <%= attachment_image_tag @post.user, :profile_image, :fill, 100, 100, format: 'jpeg', fallback: "no_image.jpg", class: "rounded-pill" %>
      <%= @post.user.name %>
    <% end %>
    <%= @post.post_time %><br>
    <%= @post.body %><br>

    <div class="mt-3"><!-- いいね、コメントの件数 -->
      <%= link_to post_path, class: "text-secondary far fa-comment" do %>
        <%= @post.post_comments.count %>
      <% end %>
    </div>


    <% if @post.user.id == current_user.id %>
      <div class="text-right">
        <%= link_to '編集', edit_post_path(@post), class: "btn btn-info btn-sm btn-s" %>
        <%= link_to '削除', post_path(@post), method: :delete, "data-confirm" =>"本当に削除しますか？", class: " btn btn-secondary btn-sm btn-s" %>
      </div>
    <% end %>

    <div class="mt-4 border-bottom"><!-- コメント一覧 -->
      <% @post.post_comments.each do |post_comment| %>
        <%= link_to user_path(post_comment.user), class: 'text-secondary'  do %>
          <%= attachment_image_tag post_comment.user, :profile_image, :fill, 40, 40, format: 'jpeg', fallback: "no_image.jpg", class: "rounded-pill" %>
          <%= post_comment.user.name %>
        <% end %>
        <%= post_comment.created_at.strftime('%Y/%m/%d') %><br>
        <%= post_comment.body %>

        <% if post_comment.user == current_user %>
          <div class="text-right">
            <%= link_to "削除", post_post_comment_path(post_comment.post, post_comment), method: :delete, class: 'btn btn-info btn-s' %>
          </div>
        <% end %>

      <% end %>
    </div>

    <div class="mt-4"><!-- 新規投稿 -->
      <%= form_with(model:[@post, @post_comment], local: true) do |f| %>
        <div class="form-group">
          <%= f.label :body, 'コメント', class: 'form-label' %>
          <%= f.text_area :body, placeholder: 'コメントを記入', class: 'form-control' %>
        </div>

        <div class="action text-center">
          <%= f.submit '送信', class: 'btn btn-info btn-s' %>
        </div>
      <% end %>
    </div>


  </div>
</div>
